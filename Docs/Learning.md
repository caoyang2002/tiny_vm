
# 进阶语法

## 闭包
参考
- [知乎参考](https://zhuanlan.zhihu.com/p/75429819)
- 推荐：[Rust语言圣经](https://course.rs/advance/functional-programing/closure.html)

闭包是一种匿名函数，它可以赋值给变量也可以作为参数传递给其它函数，不同于函数的是，它允许捕获调用者作用域中的值，例如：
```rust
fn main() {
    let x = 1;
    let sum = |y| x + y;
    assert_eq!(3, sum(2));
}

// 3
```
上面的代码展示了非常简单的闭包 sum，它拥有一个入参 y，同时捕获了作用域中的 x 的值，因此调用 sum(2) 意味着将 2（参数 y）跟 1（x）进行相加，最终返回它们的和：3。

可以看到 sum 非常符合闭包的定义：可以赋值给变量，允许捕获调用者作用域中的值。

语法

```rust
|param1, param2,...| {
    语句1;
    语句2;
    返回表达式
}
```
如果只有一个参数
```rust
|param1| 返回表达式
```



```rust
|| 42;
|x| x + 1;
|x:i32| x + 1;
|x:i32| -> i32 { x + 1 };
```

#### 关于 `->` 的解释

在 Rust 中，`->` 符号用于函数签名中，它将函数的参数列表与返回类型分隔开。在你提供的代码示例中：

```rust
let sum = |x: i32, y: i32| -> i32 {
    x + y
};
```

这里定义了一个名为 `sum` 的闭包（匿名函数），其语法分解如下：

1. `let sum`：声明一个名为 `sum` 的变量。

2. `=`：赋值操作符。

3. `|x: i32, y: i32|`：这是闭包的参数列表，其中 `x` 和 `y` 是参数名，而 `: i32` 指定了这些参数的类型为 32 位整数（`i32`）。

4. `-> i32`：这指定了闭包的返回类型，即这个闭包返回一个 `i32` 类型的值。

5. `{ x + y }`：闭包的主体，这里简单地将两个参数相加并返回结果。

6. `;`：语句结束符。

整体来看，这行代码定义了一个闭包，它接受两个 `i32` 类型的参数并返回它们相加的结果。这个闭包被赋值给了变量 `sum`，之后可以通过 `sum` 来调用这个闭包。

在 Rust 中，闭包通常用于实现回调函数，或者当你需要传递一些特定行为作为参数传递给其他函数时。闭包可以捕获并存储对它们创建时所在作用域中变量的引用，这使得它们非常灵活和强大。